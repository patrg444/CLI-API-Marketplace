{% extends "templates/base.html" %}

{% block title %}Configure API - API-Direct Creator Portal{% endblock %}
{% block description %}Advanced API configuration and marketplace settings{% endblock %}

{% block styles %}
<style>
.config-tab {
    display: inline-block;
    padding: 0.75rem 1.5rem;
    font-size: 0.875rem;
    font-weight: 500;
    color: #6b7280;
    border-bottom: 2px solid transparent;
    cursor: pointer;
    transition: all 0.2s;
}

.config-tab:hover {
    color: #4f46e5;
}

.config-tab.active {
    color: #4f46e5;
    border-bottom-color: #4f46e5;
}

.config-panel {
    display: none;
    animation: fadeIn 0.3s ease-in-out;
}

.config-panel.active {
    display: block;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}

.section-card {
    background: white;
    border: 1px solid #e5e7eb;
    border-radius: 0.75rem;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
}

.section-title {
    font-size: 1.125rem;
    font-weight: 600;
    color: #111827;
    margin-bottom: 1rem;
}

.form-group {
    margin-bottom: 1.25rem;
}

.form-label {
    display: block;
    font-size: 0.875rem;
    font-weight: 500;
    color: #374151;
    margin-bottom: 0.5rem;
}

.form-label-optional {
    color: #6b7280;
    font-weight: 400;
}

.form-help {
    font-size: 0.75rem;
    color: #6b7280;
    margin-top: 0.25rem;
}

.form-input {
    width: 100%;
    padding: 0.625rem 0.875rem;
    border: 1px solid #d1d5db;
    border-radius: 0.375rem;
    font-size: 0.875rem;
    transition: all 0.15s;
}

.form-input:focus {
    outline: none;
    border-color: #6366f1;
    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
}

.form-textarea {
    min-height: 100px;
    resize: vertical;
}

.form-select {
    appearance: none;
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
    background-position: right 0.5rem center;
    background-repeat: no-repeat;
    background-size: 1.5em 1.5em;
    padding-right: 2.5rem;
}

.toggle-switch {
    position: relative;
    display: inline-block;
    width: 48px;
    height: 24px;
}

.toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.toggle-slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #d1d5db;
    transition: .4s;
    border-radius: 24px;
}

.toggle-slider:before {
    position: absolute;
    content: "";
    height: 16px;
    width: 16px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
}

input:checked + .toggle-slider {
    background-color: #6366f1;
}

input:checked + .toggle-slider:before {
    transform: translateX(24px);
}

.image-upload-area {
    border: 2px dashed #d1d5db;
    border-radius: 0.5rem;
    padding: 2rem;
    text-align: center;
    background: #f9fafb;
    cursor: pointer;
    transition: all 0.2s;
}

.image-upload-area:hover {
    border-color: #9ca3af;
    background: #f3f4f6;
}

.image-upload-area.dragover {
    border-color: #6366f1;
    background: #eef2ff;
}

.endpoint-row {
    background: #f9fafb;
    border: 1px solid #e5e7eb;
    border-radius: 0.5rem;
    padding: 1rem;
    margin-bottom: 0.75rem;
    display: flex;
    align-items: center;
    gap: 1rem;
}

.method-select {
    width: 100px;
    font-weight: 500;
}

.method-select.GET { color: #059669; }
.method-select.POST { color: #2563eb; }
.method-select.PUT { color: #d97706; }
.method-select.DELETE { color: #dc2626; }
.method-select.PATCH { color: #7c3aed; }

.health-check-status {
    display: inline-flex;
    align-items: center;
    padding: 0.25rem 0.75rem;
    border-radius: 9999px;
    font-size: 0.75rem;
    font-weight: 500;
}

.health-check-status.success {
    background: #d1fae5;
    color: #065f46;
}

.health-check-status.failure {
    background: #fee2e2;
    color: #991b1b;
}

.health-check-status.pending {
    background: #fef3c7;
    color: #92400e;
}

.secret-header-row {
    display: grid;
    grid-template-columns: 1fr 2fr 120px 1fr auto;
    gap: 0.75rem;
    align-items: center;
    padding: 0.75rem;
    background: #f9fafb;
    border: 1px solid #e5e7eb;
    border-radius: 0.5rem;
    margin-bottom: 0.5rem;
}

.pricing-tier {
    background: white;
    border: 2px solid #e5e7eb;
    border-radius: 0.75rem;
    padding: 1.5rem;
    text-align: center;
    transition: all 0.2s;
    cursor: pointer;
}

.pricing-tier:hover {
    border-color: #d1d5db;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
}

.pricing-tier.selected {
    border-color: #6366f1;
    background: #eef2ff;
}

.pricing-tier-name {
    font-size: 1.125rem;
    font-weight: 600;
    color: #111827;
    margin-bottom: 0.5rem;
}

.pricing-tier-price {
    font-size: 2rem;
    font-weight: 700;
    color: #4f46e5;
}

.pricing-tier-price span {
    font-size: 0.875rem;
    font-weight: 400;
    color: #6b7280;
}

.inline-input {
    display: inline;
    width: 80px;
    padding: 0.25rem;
    border: 1px solid #d1d5db;
    border-radius: 0.25rem;
    text-align: center;
    font-size: 2rem;
    font-weight: 700;
    color: #4f46e5;
}

.inline-input:focus {
    outline: none;
    border-color: #6366f1;
}

.inline-input-sm {
    display: inline;
    width: 60px;
    padding: 0.125rem 0.25rem;
    border: 1px solid #d1d5db;
    border-radius: 0.25rem;
    text-align: center;
    font-size: 0.75rem;
}

.feature-row {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem;
    background: #f9fafb;
    border: 1px solid #e5e7eb;
    border-radius: 0.375rem;
}

.quota-config {
    background: #f9fafb;
    border: 1px solid #e5e7eb;
    border-radius: 0.5rem;
    padding: 1rem;
    margin-top: 0.75rem;
}

.version-badge {
    display: inline-block;
    padding: 0.25rem 0.75rem;
    background: #eef2ff;
    color: #4f46e5;
    border-radius: 9999px;
    font-size: 0.75rem;
    font-weight: 500;
}

.save-indicator {
    position: fixed;
    bottom: 2rem;
    right: 2rem;
    background: white;
    border: 1px solid #e5e7eb;
    border-radius: 0.5rem;
    padding: 1rem 1.5rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    display: none;
    align-items: center;
    gap: 0.75rem;
}

.save-indicator.saving {
    display: flex;
}

.save-indicator.saved {
    display: flex;
    border-color: #10b981;
    background: #f0fdf4;
}

.category-select {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 0.5rem;
}

.category-option {
    padding: 0.5rem 1rem;
    border: 1px solid #e5e7eb;
    border-radius: 0.375rem;
    text-align: center;
    cursor: pointer;
    transition: all 0.15s;
    font-size: 0.875rem;
}

.category-option:hover {
    border-color: #d1d5db;
    background: #f9fafb;
}

.category-option.selected {
    border-color: #6366f1;
    background: #eef2ff;
    color: #4f46e5;
    font-weight: 500;
}
</style>
{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto">
    <!-- Header -->
    <div class="mb-6 flex justify-between items-center">
        <div>
            <h1 class="text-2xl font-bold text-gray-900">Configure API</h1>
            <p class="text-gray-600 mt-1">Complete your API configuration for the marketplace</p>
        </div>
        <div class="flex items-center gap-4">
            <span class="version-badge">Version: v1</span>
            <button onclick="saveConfiguration()" class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700">
                <i class="fas fa-save mr-2"></i>Save Changes
            </button>
        </div>
    </div>

    <!-- Tab Navigation -->
    <div class="border-b border-gray-200 mb-6">
        <nav class="flex space-x-8">
            <button class="config-tab active" onclick="switchTab('general')">General</button>
            <button class="config-tab" onclick="switchTab('endpoints')">Endpoints</button>
            <button class="config-tab" onclick="switchTab('gateway')">Gateway</button>
            <button class="config-tab" onclick="switchTab('security')">Security</button>
            <button class="config-tab" onclick="switchTab('authorization')">Authorization</button>
            <button class="config-tab" onclick="switchTab('transformations')">Transformations</button>
            <button class="config-tab" onclick="switchTab('pricing')">Pricing</button>
            <button class="config-tab" onclick="switchTab('subscribers')">Subscribers</button>
        </nav>
    </div>

    <!-- General Tab -->
    <div id="general-panel" class="config-panel active">
        <!-- Basic Information -->
        <div class="section-card">
            <h2 class="section-title">General Information</h2>
            
            <div class="form-group">
                <label class="form-label">API Logo</label>
                <div class="image-upload-area" onclick="document.getElementById('logoUpload').click()" 
                     ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
                    <input type="file" id="logoUpload" accept="image/jpeg,image/png" style="display:none" onchange="handleFileSelect(event)">
                    <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-2"></i>
                    <p class="text-sm text-gray-600">Drop file to upload or click to browse</p>
                    <p class="text-xs text-gray-500 mt-1">Maximum Size: 500 x 500px, JPEG / PNG</p>
                </div>
                <div id="logoPreview" class="mt-3 hidden">
                    <img src="" alt="API Logo" class="w-24 h-24 rounded-lg object-cover">
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">Category</label>
                <div class="category-select">
                    <div class="category-option" onclick="selectCategory(this, 'tools')">Tools</div>
                    <div class="category-option" onclick="selectCategory(this, 'data')">Data</div>
                    <div class="category-option" onclick="selectCategory(this, 'financial')">Financial</div>
                    <div class="category-option" onclick="selectCategory(this, 'social')">Social</div>
                    <div class="category-option" onclick="selectCategory(this, 'location')">Location</div>
                    <div class="category-option" onclick="selectCategory(this, 'ai-ml')">AI/ML</div>
                    <div class="category-option" onclick="selectCategory(this, 'media')">Media</div>
                    <div class="category-option" onclick="selectCategory(this, 'business')">Business</div>
                    <div class="category-option" onclick="selectCategory(this, 'sports')">Sports</div>
                    <div class="category-option" onclick="selectCategory(this, 'science')">Science</div>
                    <div class="category-option" onclick="selectCategory(this, 'gaming')">Gaming</div>
                    <div class="category-option" onclick="selectCategory(this, 'other')">Other</div>
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">Short Description</label>
                <textarea id="shortDescription" class="form-input form-textarea" maxlength="200" 
                    placeholder="Describe your API in a few plain text words. Used for the API card on the Hub."></textarea>
                <p class="form-help">Describe the API in a few plain text words. Used for the API's card on the API Hub.</p>
            </div>

            <div class="form-group">
                <label class="form-label">Long Description <span class="form-label-optional">(optional)</span></label>
                <textarea id="longDescription" class="form-input form-textarea" rows="8" 
                    placeholder="Describe your API in more detail. Markdown is accepted."></textarea>
                <p class="form-help">Describe your API in more detail. Markdown is accepted. This will appear on the API listing's Endpoints tab.</p>
            </div>

            <div class="form-group">
                <label class="form-label">Website <span class="form-label-optional">(optional)</span></label>
                <input type="url" id="website" class="form-input" placeholder="https://example.com">
            </div>

            <div class="form-group">
                <label class="form-label">Terms of Use <span class="form-label-optional">(optional)</span></label>
                <input type="url" id="termsUrl" class="form-input" placeholder="https://example.com/terms">
            </div>
        </div>

        <!-- Visibility -->
        <div class="section-card">
            <h2 class="section-title">Visibility</h2>
            <p class="text-sm text-gray-600 mb-4">Switching your API visibility to Public makes it searchable and accessible to everyone on the API Hub.</p>
            
            <div class="flex items-center justify-between">
                <div>
                    <p class="font-medium text-gray-900">API Project is Public</p>
                    <p class="text-sm text-gray-600">Accessible to hundreds of thousands of developers on the Hub</p>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="isPublic" onchange="updateVisibility()">
                    <span class="toggle-slider"></span>
                </label>
            </div>
            
            <div id="publicWarning" class="mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg hidden">
                <p class="text-sm text-yellow-800">
                    <i class="fas fa-exclamation-triangle mr-2"></i>
                    Making your API public means it will be visible to all developers. Make sure your API is ready for public use.
                </p>
            </div>
        </div>

        <!-- Base URL Configuration -->
        <div class="section-card">
            <h2 class="section-title">Base URL</h2>
            <p class="text-sm text-gray-600 mb-4">Add a base URL, configure multiple URLs, override URLs, and select a load balancer</p>
            
            <div class="form-group">
                <label class="form-label">URL</label>
                <input type="url" id="baseUrl" class="form-input" placeholder="https://api.example.com">
            </div>
            
            <button class="text-sm text-indigo-600 hover:text-indigo-700">
                <i class="fas fa-plus mr-1"></i>Add additional URL
            </button>
        </div>

        <!-- Health Check -->
        <div class="section-card">
            <h2 class="section-title">Health Check</h2>
            <p class="text-sm text-gray-600 mb-4">Add a health check for your API. Once set it will be scheduled to run DAILY.</p>
            
            <div class="form-group">
                <label class="form-label">Health Check URL <span class="form-label-optional">(optional)</span></label>
                <div class="flex gap-2">
                    <input type="text" id="healthCheckBase" class="form-input flex-1" placeholder="https://api.example.com" disabled>
                    <input type="text" id="healthCheckPath" class="form-input w-48" placeholder="/health">
                </div>
            </div>
            
            <div class="flex items-center justify-between mt-4">
                <div>
                    <p class="text-sm font-medium text-gray-700">Health Check Status</p>
                    <div class="mt-1">
                        <span class="health-check-status failure">
                            <i class="fas fa-times-circle mr-1"></i>FAILURE
                        </span>
                        <span class="text-xs text-gray-500 ml-2">Last check: 12/29/2024, 10:53:31 PM</span>
                    </div>
                </div>
                <button onclick="testHealthCheck()" class="px-3 py-1.5 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 text-sm">
                    <i class="fas fa-play mr-1"></i>Test Now
                </button>
            </div>
        </div>
    </div>

    <!-- Endpoints Tab -->
    <div id="endpoints-panel" class="config-panel">
        <div class="section-card">
            <h2 class="section-title">API Endpoints</h2>
            <p class="text-sm text-gray-600 mb-4">Add and define your API endpoints. Changes made here will be reflected in the Hub.</p>
            
            <div class="mb-4">
                <input type="text" placeholder="Search endpoints..." class="form-input w-64">
            </div>
            
            <div id="endpointsList">
                <div class="endpoint-row">
                    <select class="form-select method-select POST">
                        <option value="GET">GET</option>
                        <option value="POST" selected>POST</option>
                        <option value="PUT">PUT</option>
                        <option value="PATCH">PATCH</option>
                        <option value="DELETE">DELETE</option>
                    </select>
                    <input type="text" class="form-input flex-1" value="/enhance" placeholder="/endpoint/path">
                    <input type="text" class="form-input flex-1" value="Enhance Image" placeholder="Endpoint name">
                    <button class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-pencil"></i>
                    </button>
                    <button class="text-red-400 hover:text-red-600">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
                
                <div class="endpoint-row">
                    <select class="form-select method-select POST">
                        <option value="GET">GET</option>
                        <option value="POST" selected>POST</option>
                        <option value="PUT">PUT</option>
                        <option value="PATCH">PATCH</option>
                        <option value="DELETE">DELETE</option>
                    </select>
                    <input type="text" class="form-input flex-1" value="/watermark" placeholder="/endpoint/path">
                    <input type="text" class="form-input flex-1" value="Add Watermark" placeholder="Endpoint name">
                    <button class="text-gray-400 hover:text-gray-600">
                        <i class="fas fa-pencil"></i>
                    </button>
                    <button class="text-red-400 hover:text-red-600">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </div>
            
            <div class="mt-4 flex gap-2">
                <button onclick="addEndpoint()" class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-sm">
                    <i class="fas fa-plus mr-2"></i>Create Endpoint
                </button>
                <button class="px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 text-sm">
                    <i class="fas fa-folder-plus mr-2"></i>Create Group
                </button>
            </div>
        </div>
        
        <div class="section-card">
            <h2 class="section-title">Documentation</h2>
            <p class="text-sm text-gray-600 mb-4">Adding a README empowers your API journey! Take a moment to unlock your API's full potential.</p>
            
            <button class="px-4 py-2 border border-indigo-600 text-indigo-600 rounded-md hover:bg-indigo-50 text-sm">
                <i class="fas fa-book mr-2"></i>Add README
            </button>
        </div>
    </div>

    <!-- Gateway Tab -->
    <div id="gateway-panel" class="config-panel">
        <div class="section-card">
            <h2 class="section-title">Gateway DNS</h2>
            <p class="text-sm text-gray-600 mb-4">The gateway developers use to make requests to the API.</p>
            
            <div class="p-4 bg-gray-50 border border-gray-200 rounded-lg">
                <code class="text-sm text-gray-800">https://api.api-direct.com/v1/your-api-name</code>
            </div>
        </div>
        
        <div class="section-card">
            <h2 class="section-title">Firewall Settings</h2>
            <p class="text-sm text-gray-600 mb-4">Protect your API by blocking requests that are not from the API-Direct infrastructure.</p>
            
            <div class="form-group">
                <label class="form-label">X-API-Direct-Proxy-Secret</label>
                <div class="flex gap-2">
                    <input type="password" id="proxySecret" class="form-input flex-1" value="••••••••••••••••••••••••••••••••••••" readonly>
                    <button onclick="toggleSecretVisibility()" class="px-3 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50">
                        <i class="fas fa-eye"></i>
                    </button>
                    <button onclick="copySecret()" class="px-3 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
                <p class="form-help">API-Direct adds this header on every request. This header has a unique value for each API.</p>
            </div>
            
            <div class="mt-4">
                <label class="flex items-center">
                    <input type="checkbox" class="mr-2">
                    <span class="text-sm text-gray-700">Whitelist API-Direct IPs to allow requests only from API-Direct</span>
                </label>
            </div>
        </div>
    </div>

    <!-- Security Tab -->
    <div id="security-panel" class="config-panel">
        <div class="section-card">
            <h2 class="section-title">Threat Protection</h2>
            <p class="text-sm text-gray-600 mb-4">Protects API from SQL or JavaScript injection attacks</p>
            
            <div class="flex items-center justify-between mb-4">
                <div>
                    <p class="font-medium text-gray-900">Enable Threat Protection</p>
                    <p class="text-sm text-gray-600">Automatically compare requests against pre-defined RegEx patterns</p>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="threatProtection" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
            
            <div class="p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
                <p class="text-sm text-yellow-800">
                    <i class="fas fa-info-circle mr-2"></i>
                    Threat protection requires the "Content-Type" header in requests with a body. Requests without this header will be blocked.
                </p>
            </div>
            
            <div class="mt-4">
                <label class="flex items-center">
                    <input type="checkbox" class="mr-2">
                    <span class="text-sm text-gray-700">Passthrough body if "Content-Type" is not application/json, application/x-www-form-urlencoded, or multipart/form-data</span>
                </label>
            </div>
        </div>
        
        <div class="section-card">
            <h2 class="section-title">Request Schema Validation</h2>
            <p class="text-sm text-gray-600 mb-4">Automatically validate parameters on runtime and block invalid requests</p>
            
            <div class="flex items-center justify-between mb-4">
                <div>
                    <p class="font-medium text-gray-900">Enable Schema Validation</p>
                    <p class="text-sm text-gray-600">Validate path, query and header parameters</p>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" id="schemaValidation" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
            
            <div class="space-y-3">
                <label class="flex items-start">
                    <input type="radio" name="validationMode" value="passthrough" checked class="mt-1 mr-2">
                    <div>
                        <p class="font-medium text-gray-900">Passthrough Everything (default)</p>
                        <p class="text-sm text-gray-600">Undefined parameters will not block the request</p>
                    </div>
                </label>
                
                <label class="flex items-start">
                    <input type="radio" name="validationMode" value="strip" class="mt-1 mr-2">
                    <div>
                        <p class="font-medium text-gray-900">Strip and Passthrough</p>
                        <p class="text-sm text-gray-600">Remove undefined parameters and pass the request</p>
                    </div>
                </label>
                
                <label class="flex items-start">
                    <input type="radio" name="validationMode" value="block" class="mt-1 mr-2">
                    <div>
                        <p class="font-medium text-gray-900">Block</p>
                        <p class="text-sm text-gray-600">Block requests with undefined parameters</p>
                    </div>
                </label>
            </div>
        </div>
        
        <div class="section-card">
            <h2 class="section-title">Request Configurations</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="form-group">
                    <label class="form-label">Request Size Limit</label>
                    <div class="flex items-center gap-2">
                        <input type="number" id="requestSizeLimit" class="form-input w-24" value="10" min="1" max="50">
                        <span class="text-sm text-gray-600">MB</span>
                    </div>
                    <p class="form-help">Max value is 50 MB</p>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Proxy Timeout Setting</label>
                    <div class="flex items-center gap-2">
                        <input type="number" id="proxyTimeout" class="form-input w-24" value="60" min="1" max="180">
                        <span class="text-sm text-gray-600">Seconds</span>
                    </div>
                    <p class="form-help">Max value is 180 seconds</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Authorization Tab -->
    <div id="authorization-panel" class="config-panel">
        <div class="section-card">
            <h2 class="section-title">API Authorization</h2>
            <p class="text-sm text-gray-600 mb-4">API-Direct implements a single secret key per developer application across all APIs. If your API requires additional authorization, configure it here.</p>
            
            <button class="px-4 py-2 border border-indigo-600 text-indigo-600 rounded-md hover:bg-indigo-50 text-sm">
                <i class="fas fa-shield-alt mr-2"></i>Configure Security Scheme
            </button>
        </div>
        
        <div class="section-card">
            <h2 class="section-title">Secret Headers & Parameters</h2>
            <p class="text-sm text-gray-600 mb-4">Secret request headers and parameters will be transparently added to every request</p>
            
            <div id="secretHeadersList">
                <div class="secret-header-row">
                    <input type="text" class="form-input" placeholder="Header name">
                    <input type="text" class="form-input" placeholder="Value">
                    <select class="form-input form-select">
                        <option value="header">Header</option>
                        <option value="query">Query</option>
                    </select>
                    <input type="text" class="form-input" placeholder="Description (optional)">
                    <button class="text-red-400 hover:text-red-600">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            </div>
            
            <button onclick="addSecretHeader()" class="mt-3 text-sm text-indigo-600 hover:text-indigo-700">
                <i class="fas fa-plus mr-1"></i>Add Secret Header/Parameter
            </button>
        </div>
    </div>

    <!-- Transformations Tab -->
    <div id="transformations-panel" class="config-panel">
        <div class="section-card">
            <h2 class="section-title">Request & Response Transformations</h2>
            <p class="text-sm text-gray-600 mb-4">Transformations can be used to remove, remap or add parameters in a request or response via API-Direct proxy.</p>
            
            <div class="mb-4">
                <input type="text" placeholder="Search by action and key..." class="form-input w-64">
            </div>
            
            <div class="text-center py-8 text-gray-500">
                <i class="fas fa-exchange-alt text-3xl mb-2"></i>
                <p>No transformations configured</p>
            </div>
            
            <button class="mt-4 px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-sm">
                <i class="fas fa-plus mr-2"></i>Add Transformation
            </button>
        </div>
    </div>

    <!-- Pricing Tab -->
    <div id="pricing-panel" class="config-panel">
        <div class="section-card">
            <h2 class="section-title">Pricing Model</h2>
            <p class="text-sm text-gray-600 mb-4">API-Direct supports 4 types of pricing models: free, pay per use, freemium and paid.</p>
            
            <div class="mb-6">
                <label class="form-label">Select Pricing Model</label>
                <select id="pricingModel" class="form-input form-select" onchange="updatePricingModel()">
                    <option value="freemium">Freemium (Free tier + Paid tiers)</option>
                    <option value="paid">Paid (All tiers require payment)</option>
                    <option value="payperuse">Pay Per Use (Usage-based only)</option>
                    <option value="free">Free (No payment required)</option>
                </select>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <!-- BASIC Tier -->
                <div class="pricing-tier selected" data-tier="basic">
                    <h3 class="pricing-tier-name">
                        <input type="text" class="form-input text-center font-semibold" value="BASIC" onchange="updateTierName(this, 'basic')">
                    </h3>
                    <div class="pricing-tier-price mb-4">
                        $<input type="number" class="inline-input" value="0.00" step="0.01" onchange="updateTierPrice(this, 'basic')"><span>/month</span>
                    </div>
                    
                    <div class="quota-config">
                        <h4 class="text-sm font-medium mb-3">Quotas</h4>
                        
                        <div class="space-y-3">
                            <!-- Requests Quota -->
                            <div>
                                <label class="text-xs text-gray-600">Requests / month</label>
                                <input type="number" class="form-input text-sm" value="100" placeholder="Requests">
                                <div class="flex items-center mt-1">
                                    <span class="text-xs text-gray-500">then $</span>
                                    <input type="number" class="inline-input-sm ml-1" value="0.01" step="0.001">
                                    <span class="text-xs text-gray-500 ml-1">each</span>
                                </div>
                            </div>
                            
                            <!-- Rate Limit -->
                            <div>
                                <label class="text-xs text-gray-600">Rate Limit</label>
                                <div class="flex items-center gap-1">
                                    <input type="number" class="form-input text-sm w-20" value="10">
                                    <span class="text-xs text-gray-500">per</span>
                                    <select class="form-input text-sm w-24">
                                        <option>second</option>
                                        <option>minute</option>
                                        <option>hour</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Features -->
                            <div>
                                <label class="text-xs text-gray-600">Features</label>
                                <div class="space-y-1 mt-1" id="basic-features">
                                    <label class="flex items-center text-xs">
                                        <input type="checkbox" class="mr-1" checked>
                                        <span>Basic Support</span>
                                    </label>
                                    <label class="flex items-center text-xs">
                                        <input type="checkbox" class="mr-1">
                                        <span>SSL Encryption</span>
                                    </label>
                                </div>
                                <button onclick="addFeature('basic')" class="text-xs text-indigo-600 hover:text-indigo-700 mt-1">
                                    <i class="fas fa-plus mr-1"></i>Add Feature
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- PRO Tier -->
                <div class="pricing-tier" data-tier="pro">
                    <h3 class="pricing-tier-name">
                        <input type="text" class="form-input text-center font-semibold" value="PRO" onchange="updateTierName(this, 'pro')">
                    </h3>
                    <div class="pricing-tier-price mb-4">
                        $<input type="number" class="inline-input" value="19.99" step="0.01" onchange="updateTierPrice(this, 'pro')"><span>/month</span>
                    </div>
                    
                    <div class="quota-config">
                        <h4 class="text-sm font-medium mb-3">Quotas</h4>
                        
                        <div class="space-y-3">
                            <!-- Requests Quota -->
                            <div>
                                <label class="text-xs text-gray-600">Requests / month</label>
                                <input type="number" class="form-input text-sm" value="1000" placeholder="Requests">
                                <div class="flex items-center mt-1">
                                    <span class="text-xs text-gray-500">then $</span>
                                    <input type="number" class="inline-input-sm ml-1" value="0.008" step="0.001">
                                    <span class="text-xs text-gray-500 ml-1">each</span>
                                </div>
                            </div>
                            
                            <!-- Rate Limit -->
                            <div>
                                <label class="text-xs text-gray-600">Rate Limit</label>
                                <div class="flex items-center gap-1">
                                    <input type="number" class="form-input text-sm w-20" value="30">
                                    <span class="text-xs text-gray-500">per</span>
                                    <select class="form-input text-sm w-24">
                                        <option>second</option>
                                        <option>minute</option>
                                        <option>hour</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Features -->
                            <div>
                                <label class="text-xs text-gray-600">Features</label>
                                <div class="space-y-1 mt-1" id="pro-features">
                                    <label class="flex items-center text-xs">
                                        <input type="checkbox" class="mr-1" checked>
                                        <span>Priority Support</span>
                                    </label>
                                    <label class="flex items-center text-xs">
                                        <input type="checkbox" class="mr-1" checked>
                                        <span>SSL Encryption</span>
                                    </label>
                                    <label class="flex items-center text-xs">
                                        <input type="checkbox" class="mr-1" checked>
                                        <span>Advanced Analytics</span>
                                    </label>
                                </div>
                                <button onclick="addFeature('pro')" class="text-xs text-indigo-600 hover:text-indigo-700 mt-1">
                                    <i class="fas fa-plus mr-1"></i>Add Feature
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ULTRA Tier -->
                <div class="pricing-tier" data-tier="ultra">
                    <h3 class="pricing-tier-name">
                        <input type="text" class="form-input text-center font-semibold" value="ULTRA" onchange="updateTierName(this, 'ultra')">
                    </h3>
                    <div class="pricing-tier-price mb-4">
                        $<input type="number" class="inline-input" value="49.99" step="0.01" onchange="updateTierPrice(this, 'ultra')"><span>/month</span>
                    </div>
                    
                    <div class="quota-config">
                        <h4 class="text-sm font-medium mb-3">Quotas</h4>
                        
                        <div class="space-y-3">
                            <!-- Requests Quota -->
                            <div>
                                <label class="text-xs text-gray-600">Requests / month</label>
                                <input type="number" class="form-input text-sm" value="5000" placeholder="Requests">
                                <div class="flex items-center mt-1">
                                    <span class="text-xs text-gray-500">then $</span>
                                    <input type="number" class="inline-input-sm ml-1" value="0.005" step="0.001">
                                    <span class="text-xs text-gray-500 ml-1">each</span>
                                </div>
                            </div>
                            
                            <!-- Rate Limit -->
                            <div>
                                <label class="text-xs text-gray-600">Rate Limit</label>
                                <div class="flex items-center gap-1">
                                    <input type="number" class="form-input text-sm w-20" value="60">
                                    <span class="text-xs text-gray-500">per</span>
                                    <select class="form-input text-sm w-24">
                                        <option>second</option>
                                        <option>minute</option>
                                        <option>hour</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Features -->
                            <div>
                                <label class="text-xs text-gray-600">Features</label>
                                <div class="space-y-1 mt-1" id="ultra-features">
                                    <label class="flex items-center text-xs">
                                        <input type="checkbox" class="mr-1" checked>
                                        <span>Premium Support</span>
                                    </label>
                                    <label class="flex items-center text-xs">
                                        <input type="checkbox" class="mr-1" checked>
                                        <span>SSL Encryption</span>
                                    </label>
                                    <label class="flex items-center text-xs">
                                        <input type="checkbox" class="mr-1" checked>
                                        <span>Advanced Analytics</span>
                                    </label>
                                    <label class="flex items-center text-xs">
                                        <input type="checkbox" class="mr-1" checked>
                                        <span>Custom Domain</span>
                                    </label>
                                </div>
                                <button onclick="addFeature('ultra')" class="text-xs text-indigo-600 hover:text-indigo-700 mt-1">
                                    <i class="fas fa-plus mr-1"></i>Add Feature
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- MEGA Tier -->
                <div class="pricing-tier" data-tier="mega">
                    <h3 class="pricing-tier-name">
                        <input type="text" class="form-input text-center font-semibold" value="MEGA" onchange="updateTierName(this, 'mega')">
                    </h3>
                    <div class="pricing-tier-price mb-4">
                        $<input type="number" class="inline-input" value="149.99" step="0.01" onchange="updateTierPrice(this, 'mega')"><span>/month</span>
                    </div>
                    
                    <div class="quota-config">
                        <h4 class="text-sm font-medium mb-3">Quotas</h4>
                        
                        <div class="space-y-3">
                            <!-- Requests Quota -->
                            <div>
                                <label class="text-xs text-gray-600">Requests / month</label>
                                <input type="number" class="form-input text-sm" value="20000" placeholder="Requests">
                                <div class="flex items-center mt-1">
                                    <span class="text-xs text-gray-500">then $</span>
                                    <input type="number" class="inline-input-sm ml-1" value="0.003" step="0.001">
                                    <span class="text-xs text-gray-500 ml-1">each</span>
                                </div>
                            </div>
                            
                            <!-- Rate Limit -->
                            <div>
                                <label class="text-xs text-gray-600">Rate Limit</label>
                                <div class="flex items-center gap-1">
                                    <input type="number" class="form-input text-sm w-20" value="100">
                                    <span class="text-xs text-gray-500">per</span>
                                    <select class="form-input text-sm w-24">
                                        <option>second</option>
                                        <option>minute</option>
                                        <option>hour</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Features -->
                            <div>
                                <label class="text-xs text-gray-600">Features</label>
                                <div class="space-y-1 mt-1" id="mega-features">
                                    <label class="flex items-center text-xs">
                                        <input type="checkbox" class="mr-1" checked>
                                        <span>Dedicated Support</span>
                                    </label>
                                    <label class="flex items-center text-xs">
                                        <input type="checkbox" class="mr-1" checked>
                                        <span>SSL Encryption</span>
                                    </label>
                                    <label class="flex items-center text-xs">
                                        <input type="checkbox" class="mr-1" checked>
                                        <span>Advanced Analytics</span>
                                    </label>
                                    <label class="flex items-center text-xs">
                                        <input type="checkbox" class="mr-1" checked>
                                        <span>Custom Domain</span>
                                    </label>
                                    <label class="flex items-center text-xs">
                                        <input type="checkbox" class="mr-1" checked>
                                        <span>SLA Guarantee</span>
                                    </label>
                                </div>
                                <button onclick="addFeature('mega')" class="text-xs text-indigo-600 hover:text-indigo-700 mt-1">
                                    <i class="fas fa-plus mr-1"></i>Add Feature
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Object Definition -->
            <div class="mt-8">
                <h3 class="font-medium text-gray-900 mb-3">Object Definition</h3>
                <div class="p-4 bg-gray-50 border border-gray-200 rounded-lg">
                    <p class="text-sm text-gray-700 mb-2">A call to any endpoint is <strong>one request</strong>.</p>
                    <p class="text-sm text-gray-600">Define what constitutes a billable request for your API. You can customize this based on your API's specific needs.</p>
                    <textarea id="objectDefinition" class="form-input form-textarea mt-3" placeholder="Example: Each API call counts as one request. Batch operations count as the number of items processed.">
A call to any endpoint is one request.</textarea>
                </div>
            </div>
            
            <!-- Global Features -->
            <div class="mt-8">
                <h3 class="font-medium text-gray-900 mb-3">Global Features</h3>
                <p class="text-sm text-gray-600 mb-3">Define features available across all tiers or specific to certain tiers.</p>
                
                <div id="globalFeaturesList" class="space-y-2">
                    <!-- Global features will be added here -->
                </div>
                
                <button onclick="addGlobalFeature()" class="mt-3 px-4 py-2 border border-indigo-600 text-indigo-600 rounded-md hover:bg-indigo-50 text-sm">
                    <i class="fas fa-plus mr-2"></i>Add Global Feature
                </button>
            </div>
        </div>
    </div>

    <!-- Subscribers Tab -->
    <div id="subscribers-panel" class="config-panel">
        <div class="section-card">
            <h2 class="section-title">API Subscribers</h2>
            
            <div class="mb-4">
                <input type="text" placeholder="Search username..." class="form-input w-64">
            </div>
            
            <div class="overflow-x-auto">
                <table class="min-w-full">
                    <thead>
                        <tr class="border-b border-gray-200">
                            <th class="text-left text-xs font-medium text-gray-500 uppercase tracking-wider py-3">Username</th>
                            <th class="text-left text-xs font-medium text-gray-500 uppercase tracking-wider py-3">Status</th>
                            <th class="text-left text-xs font-medium text-gray-500 uppercase tracking-wider py-3">Name</th>
                            <th class="text-left text-xs font-medium text-gray-500 uppercase tracking-wider py-3">Date Subscribed</th>
                            <th class="text-left text-xs font-medium text-gray-500 uppercase tracking-wider py-3">Plan Name</th>
                            <th class="text-left text-xs font-medium text-gray-500 uppercase tracking-wider py-3">Total Paid</th>
                            <th class="text-left text-xs font-medium text-gray-500 uppercase tracking-wider py-3">Last Active</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="py-8 text-center text-gray-500" colspan="7">
                                No subscribers yet
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Save Indicator -->
<div id="saveIndicator" class="save-indicator">
    <i class="fas fa-spinner fa-spin text-indigo-600"></i>
    <span>Saving changes...</span>
</div>

<script>
// Global state
let currentTab = 'general';
let selectedCategory = null;
let configuration = {
    general: {
        logo: null,
        category: null,
        shortDescription: '',
        longDescription: '',
        website: '',
        termsUrl: '',
        isPublic: false,
        baseUrl: '',
        healthCheckPath: '/health'
    },
    endpoints: [],
    gateway: {
        proxySecret: generateProxySecret(),
        whitelistIPs: false
    },
    security: {
        threatProtection: true,
        passthroughNonJson: false,
        schemaValidation: true,
        validationMode: 'passthrough',
        requestSizeLimit: 10,
        proxyTimeout: 60
    },
    authorization: {
        secretHeaders: []
    },
    transformations: [],
    pricing: {
        tiers: [
            { id: 'basic', name: 'BASIC', price: 0, quota: 100, overagePrice: 0.2 },
            { id: 'pro', name: 'PRO', price: 19.99, quota: 1000, overagePrice: 0.12 },
            { id: 'ultra', name: 'ULTRA', price: 49.99, quota: 5000, overagePrice: 0.08 },
            { id: 'mega', name: 'MEGA', price: 149.99, quota: 20000, overagePrice: 0.05 }
        ],
        features: []
    }
};

// Tab switching
function switchTab(tab) {
    // Update tabs
    document.querySelectorAll('.config-tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.config-panel').forEach(p => p.classList.remove('active'));
    
    // Set active
    event.target.classList.add('active');
    document.getElementById(`${tab}-panel`).classList.add('active');
    
    currentTab = tab;
}

// Category selection
function selectCategory(element, category) {
    document.querySelectorAll('.category-option').forEach(opt => opt.classList.remove('selected'));
    element.classList.add('selected');
    selectedCategory = category;
    configuration.general.category = category;
}

// File upload handling
function handleDrop(event) {
    event.preventDefault();
    event.stopPropagation();
    event.target.classList.remove('dragover');
    
    const files = event.dataTransfer.files;
    if (files.length > 0) {
        handleFile(files[0]);
    }
}

function handleDragOver(event) {
    event.preventDefault();
    event.stopPropagation();
    event.target.classList.add('dragover');
}

function handleDragLeave(event) {
    event.preventDefault();
    event.stopPropagation();
    event.target.classList.remove('dragover');
}

function handleFileSelect(event) {
    const files = event.target.files;
    if (files.length > 0) {
        handleFile(files[0]);
    }
}

function handleFile(file) {
    if (!file.type.match('image.*')) {
        showNotification('Please upload an image file', 'error');
        return;
    }
    
    if (file.size > 5 * 1024 * 1024) { // 5MB limit
        showNotification('File size must be less than 5MB', 'error');
        return;
    }
    
    const reader = new FileReader();
    reader.onload = function(e) {
        const preview = document.getElementById('logoPreview');
        preview.querySelector('img').src = e.target.result;
        preview.classList.remove('hidden');
        configuration.general.logo = e.target.result;
    };
    reader.readAsDataURL(file);
}

// Visibility toggle
function updateVisibility() {
    const isPublic = document.getElementById('isPublic').checked;
    document.getElementById('publicWarning').classList.toggle('hidden', !isPublic);
    configuration.general.isPublic = isPublic;
}

// Health check
async function testHealthCheck() {
    const button = event.target.closest('button');
    button.disabled = true;
    button.innerHTML = '<i class="fas fa-spinner fa-spin mr-1"></i>Testing...';
    
    // Simulate health check
    setTimeout(() => {
        const status = Math.random() > 0.5 ? 'success' : 'failure';
        const statusElement = document.querySelector('.health-check-status');
        
        statusElement.classList.remove('success', 'failure', 'pending');
        statusElement.classList.add(status);
        statusElement.innerHTML = `<i class="fas fa-${status === 'success' ? 'check' : 'times'}-circle mr-1"></i>${status.toUpperCase()}`;
        
        button.disabled = false;
        button.innerHTML = '<i class="fas fa-play mr-1"></i>Test Now';
        
        showNotification(`Health check ${status}`, status === 'success' ? 'success' : 'error');
    }, 2000);
}

// Endpoints management
function addEndpoint() {
    const container = document.getElementById('endpointsList');
    const endpointRow = document.createElement('div');
    endpointRow.className = 'endpoint-row';
    endpointRow.innerHTML = `
        <select class="form-select method-select GET">
            <option value="GET" selected>GET</option>
            <option value="POST">POST</option>
            <option value="PUT">PUT</option>
            <option value="PATCH">PATCH</option>
            <option value="DELETE">DELETE</option>
        </select>
        <input type="text" class="form-input flex-1" placeholder="/endpoint/path">
        <input type="text" class="form-input flex-1" placeholder="Endpoint name">
        <button class="text-gray-400 hover:text-gray-600">
            <i class="fas fa-pencil"></i>
        </button>
        <button class="text-red-400 hover:text-red-600" onclick="removeEndpoint(this)">
            <i class="fas fa-trash"></i>
        </button>
    `;
    container.appendChild(endpointRow);
}

function removeEndpoint(button) {
    button.closest('.endpoint-row').remove();
}

// Secret headers
function addSecretHeader() {
    const container = document.getElementById('secretHeadersList');
    const headerRow = document.createElement('div');
    headerRow.className = 'secret-header-row';
    headerRow.innerHTML = `
        <input type="text" class="form-input" placeholder="Header name">
        <input type="text" class="form-input" placeholder="Value">
        <select class="form-input form-select">
            <option value="header">Header</option>
            <option value="query">Query</option>
        </select>
        <input type="text" class="form-input" placeholder="Description (optional)">
        <button class="text-red-400 hover:text-red-600" onclick="removeSecretHeader(this)">
            <i class="fas fa-trash"></i>
        </button>
    `;
    container.appendChild(headerRow);
}

function removeSecretHeader(button) {
    button.closest('.secret-header-row').remove();
}

// Pricing functions
function updatePricingModel() {
    const model = document.getElementById('pricingModel').value;
    // Update UI based on pricing model
    if (model === 'free') {
        // Disable all price inputs
        document.querySelectorAll('.pricing-tier input[type="number"]').forEach(input => {
            if (input.classList.contains('inline-input')) {
                input.value = '0.00';
                input.disabled = true;
            }
        });
    } else {
        // Enable price inputs
        document.querySelectorAll('.pricing-tier input[type="number"]').forEach(input => {
            input.disabled = false;
        });
    }
}

function updateTierName(input, tier) {
    configuration.pricing.tiers.find(t => t.id === tier).name = input.value;
}

function updateTierPrice(input, tier) {
    configuration.pricing.tiers.find(t => t.id === tier).price = parseFloat(input.value);
}

function addFeature(tier) {
    const container = document.getElementById(`${tier}-features`);
    const featureLabel = document.createElement('label');
    featureLabel.className = 'flex items-center text-xs';
    featureLabel.innerHTML = `
        <input type="checkbox" class="mr-1" checked>
        <input type="text" class="inline-input-sm ml-1" placeholder="Feature name" onchange="updateFeature(this, '${tier}')">
        <button onclick="removeFeature(this)" class="ml-2 text-red-400 hover:text-red-600">
            <i class="fas fa-times text-xs"></i>
        </button>
    `;
    container.appendChild(featureLabel);
}

function removeFeature(button) {
    button.closest('label').remove();
}

function updateFeature(input, tier) {
    // Update feature in configuration
    // Implementation would sync with backend
}

function addGlobalFeature() {
    const container = document.getElementById('globalFeaturesList');
    const featureRow = document.createElement('div');
    featureRow.className = 'feature-row';
    featureRow.innerHTML = `
        <input type="text" class="form-input flex-1" placeholder="Feature name (e.g., SSL Encryption, API Analytics)">
        <select class="form-input form-select w-48">
            <option value="all">All Tiers</option>
            <option value="paid">Paid Tiers Only</option>
            <option value="custom">Custom Selection</option>
        </select>
        <div class="flex gap-2">
            <label class="text-xs flex items-center">
                <input type="checkbox" class="mr-1" checked> BASIC
            </label>
            <label class="text-xs flex items-center">
                <input type="checkbox" class="mr-1" checked> PRO
            </label>
            <label class="text-xs flex items-center">
                <input type="checkbox" class="mr-1" checked> ULTRA
            </label>
            <label class="text-xs flex items-center">
                <input type="checkbox" class="mr-1" checked> MEGA
            </label>
        </div>
        <button onclick="removeGlobalFeature(this)" class="text-red-400 hover:text-red-600">
            <i class="fas fa-trash"></i>
        </button>
    `;
    container.appendChild(featureRow);
}

function removeGlobalFeature(button) {
    button.closest('.feature-row').remove();
}

// Utility functions
function generateProxySecret() {
    return 'apd_' + Array.from({length: 32}, () => 
        '0123456789abcdefghijklmnopqrstuvwxyz'[Math.floor(Math.random() * 36)]
    ).join('');
}

function toggleSecretVisibility() {
    const input = document.getElementById('proxySecret');
    const isPassword = input.type === 'password';
    input.type = isPassword ? 'text' : 'password';
    event.target.innerHTML = `<i class="fas fa-eye${isPassword ? '-slash' : ''}"></i>`;
}

function copySecret() {
    const input = document.getElementById('proxySecret');
    const originalType = input.type;
    input.type = 'text';
    input.select();
    document.execCommand('copy');
    input.type = originalType;
    showNotification('Copied to clipboard', 'success');
}

// Save configuration
async function saveConfiguration() {
    const indicator = document.getElementById('saveIndicator');
    indicator.classList.add('saving');
    
    // Collect all form data
    configuration.general.shortDescription = document.getElementById('shortDescription').value;
    configuration.general.longDescription = document.getElementById('longDescription').value;
    configuration.general.website = document.getElementById('website').value;
    configuration.general.termsUrl = document.getElementById('termsUrl').value;
    configuration.general.baseUrl = document.getElementById('baseUrl').value;
    configuration.general.healthCheckPath = document.getElementById('healthCheckPath').value;
    
    // Simulate save
    setTimeout(() => {
        indicator.classList.remove('saving');
        indicator.classList.add('saved');
        indicator.innerHTML = '<i class="fas fa-check-circle text-green-500"></i><span>Changes saved</span>';
        
        setTimeout(() => {
            indicator.classList.remove('saved');
        }, 3000);
    }, 2000);
}

// Auto-save on input changes
document.addEventListener('input', (e) => {
    if (e.target.matches('input, textarea, select')) {
        // Debounced auto-save could be implemented here
    }
});

// Initialize
document.addEventListener('DOMContentLoaded', () => {
    // Set health check base URL from base URL input
    document.getElementById('baseUrl').addEventListener('input', (e) => {
        document.getElementById('healthCheckBase').value = e.target.value;
    });
});
</script>
{% endblock %}